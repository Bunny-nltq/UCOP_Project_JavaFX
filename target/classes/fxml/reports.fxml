<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.chart.*?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.ucop.controller.ReportViewController">
    
    <!-- Top Bar -->
    <top>
        <VBox>
            <HBox alignment="CENTER_LEFT" spacing="10" style="-fx-background-color: #FF5722; -fx-padding: 15;">
                <Button text="â† Quay láº¡i Dashboard" onAction="#handleGoBack" 
                        style="-fx-background-color: #E64A19; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 15;">
                    <font><Font size="13"/></font>
                </Button>
                <Label text="ðŸ“Š BÃ¡o CÃ¡o Thá»‘ng KÃª" textFill="white">
                    <font><Font name="System Bold" size="20"/></font>
                </Label>
            </HBox>
            
            <!-- Filter Bar -->
            <HBox spacing="15" style="-fx-padding: 15; -fx-background-color: #f5f5f5;" alignment="CENTER_LEFT">
                <Label text="Tá»« ngÃ y:"/>
                <DatePicker fx:id="dateFrom" prefWidth="150"/>
                <Label text="Äáº¿n ngÃ y:"/>
                <DatePicker fx:id="dateTo" prefWidth="150"/>
                <Button text="ðŸ“ˆ Táº¡o bÃ¡o cÃ¡o" onAction="#handleGenerateReport" 
                        style="-fx-background-color: #2196F3; -fx-text-fill: white; -fx-font-weight: bold;"/>
                <Button text="ðŸ“¥ Xuáº¥t CSV" onAction="#handleExportCSV" 
                        style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                <Button text="ðŸ“„ Xuáº¥t Excel" onAction="#handleExportExcel" 
                        style="-fx-background-color: #009688; -fx-text-fill: white;"/>
                <Button text="ðŸ–¨ï¸ In" onAction="#handlePrint" 
                        style="-fx-background-color: #9E9E9E; -fx-text-fill: white;"/>
            </HBox>
        </VBox>
    </top>
    
    <!-- Center - Report Tabs -->
    <center>
        <TabPane fx:id="reportTabPane" tabClosingPolicy="UNAVAILABLE">
            
            <!-- Tab 1: Revenue Report -->
            <Tab text="ðŸ’° Doanh Thu">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="20" style="-fx-padding: 20;">
                        <!-- Summary Cards -->
                        <HBox spacing="20">
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #4CAF50; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 200;">
                                <Label text="Tá»•ng doanh thu" textFill="white"/>
                                <Label fx:id="lblRevTotal" text="0 Ä‘" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                            
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #2196F3; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 200;">
                                <Label text="Sá»‘ Ä‘Æ¡n hÃ ng" textFill="white"/>
                                <Label fx:id="lblRevOrders" text="0" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                            
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #FF9800; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 200;">
                                <Label text="ÄÆ¡n trung bÃ¬nh" textFill="white"/>
                                <Label fx:id="lblRevAverage" text="0 Ä‘" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                        </HBox>
                        
                        <!-- Revenue Table -->
                        <VBox>
                            <Label text="Chi tiáº¿t doanh thu theo ngÃ y:" style="-fx-font-weight: bold; -fx-font-size: 16px;"/>
                            <TableView fx:id="tableRevenue" prefHeight="400">
                                <columns>
                                    <TableColumn fx:id="colRevenueDate" text="NgÃ y" prefWidth="120"/>
                                    <TableColumn fx:id="colRevenueAmount" text="Doanh thu" prefWidth="150"/>
                                    <TableColumn fx:id="colRevenueOrders" text="Sá»‘ Ä‘Æ¡n" prefWidth="100"/>
                                    <TableColumn fx:id="colRevenueAvg" text="TB/Ä‘Æ¡n" prefWidth="150"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>
            
            <!-- Tab 2: Payment Methods -->
            <Tab text="ðŸ’³ PhÆ°Æ¡ng Thá»©c Thanh ToÃ¡n">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="20" style="-fx-padding: 20;">
                        <HBox spacing="30" alignment="CENTER">
                            <PieChart fx:id="chartPaymentMethods" prefWidth="400" prefHeight="400"/>
                            <TableView fx:id="tablePaymentMethods" prefWidth="400">
                                <columns>
                                    <TableColumn fx:id="colPaymentMethod" text="PhÆ°Æ¡ng thá»©c" prefWidth="150"/>
                                    <TableColumn fx:id="colPaymentAmount" text="Doanh thu" prefWidth="150"/>
                                    <TableColumn fx:id="colPaymentPercent" text="Tá»· lá»‡ %" prefWidth="100"/>
                                </columns>
                            </TableView>
                        </HBox>
                    </VBox>
                </ScrollPane>
            </Tab>
            
            <!-- Tab 3: Orders Statistics -->
            <Tab text="ðŸ“¦ Thá»‘ng KÃª ÄÆ¡n HÃ ng">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="20" style="-fx-padding: 20;">
                        <!-- Order Summary Cards -->
                        <HBox spacing="20">
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #4CAF50; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 150;">
                                <Label text="Tá»•ng Ä‘Æ¡n" textFill="white"/>
                                <Label fx:id="lblTotalOrders" text="0" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                            
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #2196F3; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 150;">
                                <Label text="HoÃ n thÃ nh" textFill="white"/>
                                <Label fx:id="lblCompletedOrders" text="0" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                            
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #f44336; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 150;">
                                <Label text="ÄÃ£ há»§y" textFill="white"/>
                                <Label fx:id="lblCanceledOrders" text="0" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                            
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #FF9800; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 150;">
                                <Label text="HoÃ n tiá»n" textFill="white"/>
                                <Label fx:id="lblRefundedOrders" text="0" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                        </HBox>
                        
                        <!-- Order Status Chart -->
                        <HBox spacing="30" alignment="CENTER">
                            <PieChart fx:id="chartOrderStatus" prefWidth="400" prefHeight="400"/>
                        </HBox>
                    </VBox>
                </ScrollPane>
            </Tab>
            
            <!-- Tab 4: Top Products -->
            <Tab text="ðŸ† Sáº£n Pháº©m BÃ¡n Cháº¡y">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="20" style="-fx-padding: 20;">
                        <HBox spacing="30">
                            <VBox spacing="10" HBox.hgrow="ALWAYS">
                                <Label text="Top 10 sáº£n pháº©m bÃ¡n cháº¡y:" style="-fx-font-weight: bold; -fx-font-size: 16px;"/>
                                <BarChart fx:id="chartTopProducts" prefHeight="400">
                                    <xAxis>
                                        <CategoryAxis label="Sáº£n pháº©m"/>
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis label="Sá»‘ lÆ°á»£ng"/>
                                    </yAxis>
                                </BarChart>
                            </VBox>
                        </HBox>
                        
                        <TableView fx:id="tableTopProducts" prefHeight="300">
                            <columns>
                                <TableColumn fx:id="colProductRank" text="#" prefWidth="50"/>
                                <TableColumn fx:id="colProductName" text="Sáº£n pháº©m" prefWidth="300"/>
                                <TableColumn fx:id="colProductQuantity" text="Sá»‘ lÆ°á»£ng bÃ¡n" prefWidth="120"/>
                                <TableColumn fx:id="colProductRevenue" text="Doanh thu" prefWidth="150"/>
                                <TableColumn fx:id="colProductOrders" text="Sá»‘ Ä‘Æ¡n" prefWidth="100"/>
                            </columns>
                        </TableView>
                    </VBox>
                </ScrollPane>
            </Tab>
            
            <!-- Tab 5: Inventory -->
            <Tab text="ðŸ“¦ Tá»“n Kho">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="20" style="-fx-padding: 20;">
                        <!-- Inventory Summary -->
                        <HBox spacing="20">
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #2196F3; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 200;">
                                <Label text="Tá»•ng sáº£n pháº©m" textFill="white"/>
                                <Label fx:id="lblTotalItems" text="0" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                            
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #f44336; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 200;">
                                <Label text="Sáº¯p háº¿t hÃ ng" textFill="white"/>
                                <Label fx:id="lblLowStockItems" text="0" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                            
                            <VBox alignment="CENTER" spacing="5" style="-fx-background-color: #FF9800; -fx-padding: 20; -fx-background-radius: 10; -fx-min-width: 200;">
                                <Label text="Háº¿t hÃ ng" textFill="white"/>
                                <Label fx:id="lblOutOfStockItems" text="0" textFill="white" 
                                       style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                            </VBox>
                        </HBox>
                        
                        <!-- Low Stock Table -->
                        <VBox>
                            <Label text="Sáº£n pháº©m sáº¯p háº¿t hÃ ng:" style="-fx-font-weight: bold; -fx-font-size: 16px; -fx-text-fill: #f44336;"/>
                            <TableView fx:id="tableLowStock" prefHeight="400">
                                <columns>
                                    <TableColumn fx:id="colStockWarehouse" text="Kho" prefWidth="150"/>
                                    <TableColumn fx:id="colStockItem" text="Sáº£n pháº©m" prefWidth="250"/>
                                    <TableColumn fx:id="colStockQuantity" text="Tá»“n kho" prefWidth="100"/>
                                    <TableColumn fx:id="colStockStatus" text="Tráº¡ng thÃ¡i" prefWidth="120"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>
            
        </TabPane>
    </center>
    
    <!-- Bottom Status Bar -->
    <bottom>
        <HBox alignment="CENTER_LEFT" spacing="10" style="-fx-background-color: #f0f0f0; -fx-padding: 8;">
            <Label text="Tráº¡ng thÃ¡i:"/>
            <Label fx:id="lblStatus" text="Sáºµn sÃ ng" style="-fx-text-fill: green;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="lblLastUpdate" text="Cáº­p nháº­t láº§n cuá»‘i: --"/>
        </HBox>
    </bottom>
    
</BorderPane>
